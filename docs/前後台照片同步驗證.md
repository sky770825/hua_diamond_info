# 前後台照片同步驗證

## 結論：會同步

當**後台使用 admin-full.html**且**前端有設定 Supabase 環境變數**時，後台上傳的形象照與新作品會寫入同一個 Supabase 專案；前端**重新整理或按「重新整理」**後就會顯示新照片。

---

## 資料流

| 步驟 | 後台 (admin-full.html) | 前端 (成員牆) |
|------|------------------------|----------------|
| 1 | 上傳形象照 → Supabase Storage `hua-diamond-images/avatars/{no}_{ts}.ext` | — |
| 2 | 取得 public URL → 寫入 `hua_members.avatar` | — |
| 3 | 上傳作品 → Storage `hua-diamond-images/portfolio/{no}/{ts}.ext` | — |
| 4 | 取得 public URL → 寫入 `hua_member_portfolios.image` | — |
| 5 | — | `fetchMembers()` 讀取 `hua_members` + `hua_member_portfolios`（同專案） |
| 6 | — | `member.avatar`、`member.portfolio[].image` 為完整 Supabase URL |
| 7 | — | `portfolioImageUrl(url)` 對 `http` 開頭直接回傳，`<img src={url}>` 顯示 |

- 後台與前端都用**同一個 Supabase 專案**（同一組 URL / anon key）。
- 後台寫入的欄位（`avatar`、`image`）與前端讀取、顯示的欄位一致，沒有轉換或過濾掉 URL。

---

## 必要條件

1. **前端**：建置／執行時有設定 `VITE_SUPABASE_URL`、`VITE_SUPABASE_PUBLISHABLE_KEY`（與後台同專案）。
2. **後台**：使用 **admin-full.html**（寫 Supabase），不要用 backend 的 admin.html（寫的是本機／Express 後端，不會進 Supabase）。
3. **看到新照片的時機**：前端**重新整理頁面**或按成員牆的**「重新整理」按鈕**後，會再呼叫 `fetchMembers()`，就會拿到最新的 `avatar` 與作品 `image`。

---

## 若前端沒看到新照片

1. 確認前端環境變數是**同一個 Supabase 專案**（與 admin-full 的 `SUPABASE_URL` / key 一致）。
2. 確認有**重新整理**或按「重新整理」再檢查。
3. 若部署在 Vercel 等：確認該環境的 **Environment Variables** 有設 `VITE_SUPABASE_URL`、`VITE_SUPABASE_PUBLISHABLE_KEY` 並重新部署。
