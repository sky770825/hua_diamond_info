# 為什麼完整管理後台沒有在網頁上？

## 一、目前架構

| 元件 | 位置 | 說明 |
|------|------|------|
| **前端（成員牆）** | Cloudflare Pages：https://hua-diamond-info.pages.dev | 靜態網頁，已部署 ✅ |
| **後端 + 完整管理後台** | 本機：http://localhost:3001/admin | 需執行 `npm run dev:backend`，**尚未部署** ❌ |

## 二、原因說明

**Cloudflare Pages 只提供靜態檔案**（HTML、JS、CSS、圖片），無法執行：
- Node.js 後端
- API（GET/POST/PUT/DELETE）
- 檔案上傳（形象照、作品集圖片）
- 資料庫或 JSON 寫入

**完整管理後台**（`backend/public/admin.html`）需要後端才能運作，因為它會：
- 讀寫成員資料（`/api/members`）
- 上傳形象照（`POST /api/members/:no/avatar`）
- 上傳作品集（`POST /api/members/:no/portfolio`）
- 刪除成員、作品

所以：**前端在 Pages 上線，後端仍在本地 → 完整管理後台目前只能在本機使用**。

---

## 三、解決方案：部署後端

要讓完整管理後台在網頁上可用，需要**將後端部署到雲端**（例如 Zeabur、Railway、Render）。

### 步驟概覽

1. **部署後端到 Zeabur**
2. **取得後端網址**（例如 `https://xxx.zeabur.app`）
3. **在 Cloudflare Pages 設定環境變數**
   - `API_URL` = 後端網址（不含結尾 `/`）
   - `ADMIN_URL` = 後端網址
4. **重新建置並部署前端** → 點「管理後台」會連到後端的 admin 頁面

### Zeabur 部署後端步驟

1. 到 [Zeabur](https://zeabur.com) → 選擇專案
2. **Add Service** → **Deploy from GitHub** → 選擇 `hua_diamond_info` repo
3. **設定 Root Directory**：`backend`（只部署 backend 資料夾）
4. Zeabur 會自動偵測 Node.js 並執行 `npm start`
5. 部署完成後，取得後端網址（例如 `https://xxx.zeabur.app`）
6. 在 **Cloudflare Pages** 專案設定環境變數：
   - `API_URL` = 後端網址（不含結尾 `/`）
   - `ADMIN_URL` = 後端網址
7. 重新部署前端（push 或手動觸發）

**DATABASE_URL**：若在 Zeabur 將後端服務與 PostgreSQL 連結，Zeabur 會自動注入 `DATABASE_URL`。後端會優先使用 PostgreSQL（`hua_internation` schema），未設定時則使用本機 `members.json`。

---

## 四、目前後端狀態

- **資料儲存**：
  - 有 `DATABASE_URL`：使用 Zeabur PostgreSQL `hua_internation` schema ✅
  - 無 `DATABASE_URL`：使用本機 `backend/data/members.json`
- **上傳儲存**：`backend/uploads/`（本機目錄；Zeabur 容器重啟可能遺失）

---

## 五、快速對照

| 情境 | 完整管理後台 | 說明 |
|------|--------------|------|
| 本機 + 後端啟動 | ✅ http://localhost:3001/admin | 可用 |
| 生產網站（前端） | ❌ 僅唯讀預覽 | 需部署後端後才可用完整功能 |
| 生產 + 後端已部署 | ✅ https://後端網址/admin | 需完成 Zeabur 部署 |
